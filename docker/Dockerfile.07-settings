# Layer 7: User settings and bootstrap
FROM claude-code:layer-06-jekyll AS settings-layer

# Switch to claude user for settings
USER claude
WORKDIR /home/claude

# Clone settings repository
RUN git clone https://github.com/idvorkin/settings.git /home/claude/settings

# Run bootstrap script (make it executable first)
RUN cd /home/claude/settings && \
    chmod +x bootstrap.sh && \
    ./bootstrap.sh || true

# Set up neovim config symlink (assuming settings has nvim config)
RUN mkdir -p /home/claude/.config && \
    ln -sf /home/claude/settings/nvim /home/claude/.config/nvim || true

# Switch back to root for any additional system-level changes
USER root

# Save this layer
FROM settings-layer AS layer-07-settings