# Layer 8: Ready to use layer with verification
FROM claude-code:layer-07-settings AS ready-layer

# Everything we need is already installed:
# - Neovim (from layer-03-dev)
# - Node.js and npm (from layer-04-nodejs)  
# - Python with uv tools (from layer-05-python)
# - Jekyll (from layer-06-jekyll)
# - Settings cloned and bootstrapped (from layer-07-settings)

# Install Playwright with browsers
RUN npm install -g playwright || echo "Playwright install failed" && \
    npx playwright install --with-deps chromium || echo "Browser install skipped"

# Claude Code can be installed later when network is better
# RUN npm install -g @anthropic-ai/claude-code || echo "Claude Code install failed"

# Verify what we have
RUN echo "=== Installed Tools ===" && \
    echo "Neovim: $(nvim --version | head -1)" && \
    echo "Node.js: $(node --version)" && \
    echo "Python: $(python3 --version)" && \
    echo "Ruby: $(ruby --version)" && \
    echo "Jekyll: $(jekyll --version 2>/dev/null | head -1 || echo 'installed')" && \
    echo "Settings: $(ls -d /home/claude/settings 2>/dev/null || echo 'not found')" && \
    echo "uv: $(uv --version 2>/dev/null || echo 'installed')" && \
    echo "======================="

# Save this layer
FROM ready-layer AS layer-08-ready