# Final assembly - combines all layers
FROM claude-code:layer-08-extras AS final

# Switch to claude user
USER claude
WORKDIR /home/claude

# Set up paths
RUN echo 'export PATH="$HOME/.cargo/bin:$HOME/.local/bin:$PATH"' >> ~/.bashrc && \
    echo 'export PATH="$HOME/.cargo/bin:$HOME/.local/bin:$PATH"' >> ~/.zshrc

# Create necessary directories
RUN mkdir -p ~/.config ~/.ssh ~/.local/bin ~/scripts ~/.cache

# Copy scripts
COPY --chown=claude:claude scripts/ /home/claude/scripts/
RUN chmod +x /home/claude/scripts/*.sh

WORKDIR /workspace

ENTRYPOINT ["/home/claude/scripts/entrypoint.sh"]
CMD ["/bin/bash"]