{"mappings":"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","sources":["src/index.ts","src/main_module.ts","src/graph.ts","src/main.ts"],"sourcesContent":["console.log(\"++ -blog-module:success!\");\nimport \"./main_module\";\nimport \"./graph\";\n\nconsole.log(\"-- -blog-module:success!\");\n","/**\n * Replaces placeholder links in the document with their corresponding list content.\n * @param listReplacements - An object mapping placeholder texts to list elements.\n */\nexport function replacePlaceholdersWithLists(listReplacements) {\n  Object.entries(listReplacements).forEach(([placeholderText, list]) => {\n    const placeholderLink = $(`a[href=${placeholderText}]`).first();\n    if (!placeholderLink.length) return; // Placeholder not found, skip\n\n    const listClone = $(list).clone();\n    listClone\n      .children()\n      .first()\n      .remove(); // Remove the 'lookup id' from the list\n    placeholderLink.replaceWith(listClone);\n\n    // remove the list from the document\n    $(list).remove();\n  });\n}\n\n/**\n * Replaces list placeholders in tables with actual list content.\n * This function orchestrates the process of finding and replacing placeholders.\n */\nexport function replaceListPlaceholdersInTables() {\n  console.log(\"Replacing List Placeholders in Tables\");\n  const listReplacements = buildListReplacementMap();\n  replacePlaceholdersWithLists(listReplacements);\n}\n\n/**\n * Builds a map of list replacements by scanning the document for specially formatted lists.\n * @returns An object where keys are placeholder texts and values are the corresponding list elements.\n */\nfunction buildListReplacementMap() {\n  const replacements = {};\n  $(\"ul\").each((_, list) => {\n    const firstListItem = list.firstElementChild;\n    if (!firstListItem) return;\n\n    const firstItemText = firstListItem.textContent;\n    if (!firstItemText.startsWith(\"l\")) return;\n\n    const listId = parseInt(firstItemText.substring(1));\n    if (isNaN(listId)) return;\n\n    replacements[firstItemText] = list;\n  });\n  return replacements;\n}\n\n$(replaceListPlaceholdersInTables);\n","//\n//  main.js\n//\n// Random tree\n// Tree copied from: https://github.com/vasturiano/force-graph\nconsole.log(\"Load force graph in TS v 0.9\");\nimport { get_link_info, MakeBackLinkHTML } from \"./main\";\n//import ForceGraph from \"force-graph\";\n\n// Pages are the link_infos\n// Set id to be the URL.\n\n// Example to make collapsable tree:\n// https://github.com/vasturiano/force-graph/blob/master/example/expandable-nodes/index.html\n\n// Uncollapse any page wtih the url == eulogy\nfunction is_initial_expanded(node) {\n  if (node.url == first_expanded) {\n    return true;\n  }\n\n  return false;\n}\n\nconst pages = Object.values(await get_link_info()).map(p => ({\n  ...p,\n  id: p.url,\n  expanded: false,\n}));\n\nconst slug = \"/\" + window.location.href.split(\"#\")[1];\nconst initial_expanded_url = pages.map(p => p.url).includes(slug)\n  ? slug\n  : \"/eulogy\";\n\npages.forEach(p => {\n  p.expanded = p.url == initial_expanded_url;\n});\n\nfunction is_valid_url(url) {\n  // check if the url is in the list of pages\n  return pages.map(p => p.url).includes(url);\n}\nfunction build_links(pages) {\n  // build links\n  const links = [];\n  pages.forEach(page => {\n    page.outgoing_links\n      .concat(page.incoming_links)\n      .filter(is_valid_url) // We have lots of dead links, go fix them in the source material\n      .forEach(target => {\n        links.push({ source: page, target, value: 1 });\n      });\n\n    //page.incoming_links.forEach(target => {\n    //links.push({ source: target, target: source, value: 1 });\n    //});\n  });\n  return links;\n}\n\nfunction node_for_url(pages, url) {\n  return pages.filter(p => p.url == url)[0];\n}\n\nfunction build_graph_data(pages) {\n  const visible_pages = pages.filter(page => page.expanded);\n  const visible_links = build_links(visible_pages);\n  const newly_visible_pages = visible_links.map(l =>\n    node_for_url(pages, l.target)\n  );\n  // update visable pages with newly visible ones\n  const combined_pages = visible_pages.concat(newly_visible_pages);\n  return {\n    nodes: combined_pages,\n    links: visible_links,\n  };\n}\n\n// Make tree collapasable\n\nfunction TextLabelNodeCanvas(node, ctx, globalScale: number) {\n  const outgoingCount = node.outgoing_links.length;\n  const expandedText = node.expanded ? \"-\" : `+${outgoingCount}`;\n  const label = node.id + \" [\" + expandedText + \"]\";\n  const fontSize = 12 / globalScale;\n  ctx.font = `${fontSize}px Sans-Serif`;\n  const textWidth = ctx.measureText(label).width;\n  const bckgDimensions = [textWidth, fontSize].map(n => n + fontSize * 0.2); // some padding\n\n  ctx.fillStyle = \"rgba(255, 255, 255, 0.8)\";\n  ctx.fillRect(\n    node.x - bckgDimensions[0] / 2,\n    node.y - bckgDimensions[1] / 2,\n    ...bckgDimensions\n  );\n\n  ctx.textAlign = \"center\";\n  ctx.textBaseline = \"middle\";\n  ctx.fillStyle = node.color;\n  ctx.fillText(label, node.x, node.y);\n\n  node.__bckgDimensions = bckgDimensions; // to re-use in nodePointerAreaPaint\n}\n\nfunction TextLabelNodePointerAreaPaint(node, color, ctx) {\n  ctx.fillStyle = color;\n  const bckgDimensions = node.__bckgDimensions;\n  bckgDimensions &&\n    ctx.fillRect(\n      node.x - bckgDimensions[0] / 2,\n      node.y - bckgDimensions[1] / 2,\n      ...bckgDimensions\n    );\n}\n// If ForceGraph isn't defined, return\n\nif (typeof ForceGraph === \"undefined\") {\n  console.log(\"Force Graph not defined\");\n} else {\n  const Graph = ForceGraph()(document.getElementById(\"graph\"))\n    .graphData(build_graph_data(pages))\n    .nodeLabel(\"id\")\n    .nodeAutoColorBy(\"group\")\n    .nodeCanvasObject(TextLabelNodeCanvas)\n    .nodePointerAreaPaint(TextLabelNodePointerAreaPaint)\n    .onNodeRightClick(node => {\n      // Open the node in a new tab\n      window.open(node.url, \"_blank\");\n    })\n    .onNodeClick(node => {\n      // Center/zoom on node\n      console.log(node);\n\n      // count expanded nodes\n      node.expanded = !node.expanded;\n      const expanded_nodes = pages.filter(p => p.expanded).length;\n      if (expanded_nodes == 0) {\n        // re-expand me.\n        node.expanded = true;\n      }\n      Graph.graphData(build_graph_data(pages));\n\n      // center on node in 300 ms, post graph update\n      setTimeout(() => {\n        center_on_node(node);\n      }, 300);\n    });\n\n  center_on_node(node_for_url(pages, initial_expanded_url));\n\n  function center_on_node(node) {\n    Graph.centerAt(node.x, node.y, 500);\n    Graph.zoom(8, 500);\n    update_detail(node);\n    console.log(\"centering on\", node);\n  }\n\n  var g_last_detail_node = null;\n\n  // set click handler for center control\n  $(\"#center_control\").on(\"click\", () => center_on_node(g_last_detail_node));\n\n  // set click handler for goto control\n  $(\"#goto_control\").on(\"click\", open_goto_control);\n\n  // set click handler for collapse control\n  $(\"#collapse_control\").on(\"click\", collapse_all_except_active);\n\n  function open_goto_control() {\n    console.log(\"Goto control clicked\");\n    if (g_last_detail_node) {\n      if (g_last_detail_node.url) {\n        window.open(g_last_detail_node.url, \"_blank\");\n      } else {\n        console.log(\"Active node has no URL\");\n      }\n    } else {\n      console.log(\"No active node to go to\");\n    }\n  }\n\n  function collapse_all_except_active() {\n    console.log(\"Collapse control clicked\");\n    pages.forEach(p => {\n      p.expanded = false;\n    });\n    if (g_last_detail_node) {\n      g_last_detail_node.expanded = true;\n    }\n    Graph.graphData(build_graph_data(pages));\n\n    // Center on the active node after collapsing\n    if (g_last_detail_node) {\n      setTimeout(() => {\n        center_on_node(g_last_detail_node);\n      }, 300);\n    }\n  }\n\n  function update_detail(page) {\n    // replace html of element of id above with the page\n    g_last_detail_node = page;\n    const html = MakeBackLinkHTML(page);\n    const detail = document.getElementById(\"detail\");\n    detail.innerHTML = html;\n  }\n}\n\nconsole.log(\"Post Graph\");\n","let tocExpand = true;\n\nfunction checkExpandToggle() {\n  const toc = $(\".ui-toc-dropdown .toc\");\n  const toggle = $(\".expand-toggle\");\n  if (!tocExpand) {\n    toc.removeClass(\"expand\");\n    toggle.text(\"Expand all\");\n  } else {\n    toc.addClass(\"expand\");\n    toggle.text(\"Collapse all\");\n  }\n}\n\nfunction SwapProdAndTest() {\n  /* Find page title. */\n  const url = window.location.href;\n  const prodPrefix = \"https://idvork.in\";\n  const testPrefix = \"http://localhost:4000\";\n  const isProd = url.includes(prodPrefix);\n  let newURL = url;\n  if (isProd) {\n    newURL = url.replace(prodPrefix, testPrefix);\n  } else {\n    newURL = url.replace(testPrefix, prodPrefix);\n  }\n\n  window.location.href = newURL;\n}\n\nfunction ForceShowRightSideBar() {\n  let toc = $(\"#right-sidebar\");\n  let mainContent = $(\"#main-content\");\n  toc.removeClass();\n  toc.addClass(\"col-4 pl-0\");\n\n  mainContent.removeClass();\n  mainContent.addClass(\"col-8 pr-0\");\n\n  // Hide DropUp\n  const tocDropUp = $(\"#id-ui-toc-dropdown\");\n  tocDropUp.removeClass();\n  tocDropUp.addClass(\"d-none\");\n}\n\n// <!-- Copied from hackmd-extras.js -->\nfunction generateToc(id, showPinToc) {\n  const target = $(`#${id}`);\n  target.html(\"\");\n  /* eslint-disable no-unused-vars */\n  /* @ts-ignore:TS2339*/\n  const toc = new window.Toc(\"content-holder\", {\n    level: 3,\n    top: -1,\n    class: \"toc\",\n    ulClass: \"nav\",\n    targetId: id,\n  });\n  /* eslint-enable no-unused-vars */\n  if (target.text() === \"undefined\") {\n    target.html(\"\");\n  }\n  const tocMenu = $('<div class=\"toc-menu\"></div');\n  const toggle = $('<a class=\"expand-toggle\" href=\"#\">Collapse all</a>');\n  const backToTop = $('<a class=\"back-to-top\" href=\"#\">Top of page</a>');\n  const gotoBottom = $('<a class=\"go-to-bottom\" href=\"#\">Bottom of page</a>');\n  const forceSideBar = $('<a class=\"go-to-bottom\" href=\"#\">Pin ToC</a>');\n  checkExpandToggle();\n  toggle.click(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    tocExpand = !tocExpand;\n    checkExpandToggle();\n  });\n  backToTop.click(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    window.scrollTo(0, 0);\n  });\n  gotoBottom.click(e => {\n    e.preventDefault();\n    e.stopPropagation();\n    window.scrollTo(0, document.body.scrollHeight);\n  });\n  forceSideBar.click(e => ForceShowRightSideBar());\n  tocMenu.append(toggle).append(backToTop).append(gotoBottom);\n  if (showPinToc) {\n    tocMenu.append(forceSideBar);\n  }\n  target.append(tocMenu);\n}\n\nfunction MakeBackLinkHTML(url_info: IURLInfo) {\n  const title_href = `<a href=${url_info.url}>${url_info.title}</a>`;\n  const class_link = `link-box description truncate-css`;\n  const output = `\n<div>\n    <div class=\"${class_link}\"> ${title_href}:<span class=\"link-description\"> ${url_info.description} <span></div>\n</div>`;\n  return output;\n}\n\nasync function AddLinksToPage(allUrls: IURLInfoMap) {\n  // TODO handle redirects\n  const page_path = new URL(document.URL).pathname;\n  const backlinks = allUrls[page_path]?.incoming_links;\n  const frontlinks = allUrls[page_path]?.outgoing_links;\n\n  if (!backlinks && !frontlinks) {\n    console.log(`No backlinks for the page ${page_path}`);\n    return;\n  }\n\n  let link_parent_location = $(\"#links-to-page\");\n  if (!link_parent_location) {\n    console.log(\"No back_link_location\");\n    return;\n  }\n\n  link_parent_location.append(\n    `\n<ul class=\"nav nav-tabs nav-fill\" id=\"myTab\" role=\"tablist\">\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link active\" id=\"home-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#incoming\" type=\"button\" role=\"tab\" aria-controls=\"incoming\" aria-selected=\"true\">Links to here</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"profile-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#outgoing\" type=\"button\" role=\"tab\" aria-controls=\"outgoing\" aria-selected=\"false\">Link from here</button>\n  </li>\n  <li class=\"nav-item\" role=\"presentation\">\n    <button class=\"nav-link\" id=\"profile-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#graph\" type=\"button\" role=\"tab\" aria-controls=\"outgoing\" aria-selected=\"false\">Graph</button>\n  </li>\n</ul>\n<div class=\"tab-content\" id=\"myTabContent\">\n  <div class=\"tab-pane fade show active \" id=\"incoming\" role=\"tabpanel\" aria-labelledby=\"incoming-tab\"></div>\n  <div class=\"tab-pane fade\" id=\"outgoing\" role=\"tabpanel\" aria-labelledby=\"outgoing-tab\"></div>\n  <div class=\"tab-pane fade\" id=\"graph\" role=\"tabpanel\" aria-labelledby=\"outgoing-tab\">\n    <span> View the graph for: </span>\n  </div>\n</div>\n`\n  );\n\n  let incoming_location = link_parent_location.find(\"#incoming\");\n  var sort_descending_by_size = (a, b) =>\n    Number(allUrls[b].doc_size) - Number(allUrls[a].doc_size);\n\n  if (backlinks) {\n    for (var link of backlinks.sort(sort_descending_by_size)) {\n      const url_info = allUrls[link];\n      incoming_location.append(MakeBackLinkHTML(url_info));\n    }\n  }\n\n  // remove front links not in\n  let clean_front_links = [];\n  for (var link of frontlinks) {\n    if (allUrls[link]) {\n      clean_front_links.push(link);\n    }\n  }\n\n  let outgoing_location = link_parent_location.find(\"#outgoing\");\n  if (clean_front_links) {\n    for (let link of clean_front_links.sort(sort_descending_by_size)) {\n      const url_info = allUrls[link];\n      outgoing_location.append(MakeBackLinkHTML(url_info));\n    }\n  }\n  console.log(\"Added Graph\");\n  const graph_location = link_parent_location.find(\"#graph\");\n  const stripped_page_path = page_path.replace(/\\//g, \"\");\n  graph_location.append(\n    `<a href='/graph#${stripped_page_path}'>${page_path} (${stripped_page_path}) </a>`\n  );\n}\nfunction make_html_summary_link(link, url_info: IURLInfo) {\n  const attribution = `(From:<a href='${url_info.url}'> ${url_info.title}</a>)`;\n\n  return `<div>\n        <i> ${url_info.description}</i> ${attribution}\n    </div>`;\n}\n\nfunction make_html_summary_link_error(link, error) {\n  return `<span class='text-danger'>Error: Invalid link for ${link.attr(\n    \"href\"\n  )} ${error} </span>`;\n}\n\nfunction AddSummarysToPage(backLinks: IBacklinks) {\n  const summary_links = $.makeArray($(\".summary-link\"));\n  summary_links.forEach(raw_link => {\n    const link = $(raw_link);\n    try {\n      console.log(link.attr(\"href\"));\n\n      let ref = link.attr(\"href\");\n\n      // Resolve redirect\n      if (backLinks.redirects[ref] != undefined) {\n        ref = backLinks.redirects[ref];\n      }\n      // Look up in url info\n      if (backLinks.url_info[ref] == undefined) {\n        link.html(make_html_summary_link_error(link, \"not found in url info\"));\n        return;\n      }\n\n      link.html(make_html_summary_link(link, backLinks.url_info[ref]));\n    } catch (e) {\n      link.html(make_html_summary_link_error(link, e));\n    }\n  });\n}\n\nasync function add_link_loader() {\n  AddLinksToPage(await get_link_info());\n  AddSummarysToPage(await get_back_links());\n}\n\nexport interface IBacklinks {\n  redirects: { [key: string]: string };\n  url_info: IURLInfoMap;\n}\n\nexport interface IURLInfoMap {\n  [key: string]: IURLInfo;\n}\n\nexport interface IURLInfo {\n  url: string;\n  title: string;\n  description: string;\n  file_path: string;\n  outgoing_links: string[];\n  incoming_links: string[];\n  redirect_url: string;\n  doc_size: number;\n}\n\nlet cached_back_links: IBacklinks = null;\nasync function get_back_links(): Promise<IBacklinks> {\n  if (cached_back_links != null) {\n    return cached_back_links;\n  }\n  const url = window.location.href;\n  const prodPrefix = \"https://idvork.in\";\n  const isProd = url.includes(prodPrefix);\n\n  var backlinks_url = \"\";\n  if (isProd) {\n    backlinks_url =\n      \"https://raw.githubusercontent.com/idvorkin/idvorkin.github.io/master/back-links.json?flush_cache=True\";\n  } else {\n    backlinks_url = \"/back-links.json\";\n  }\n\n  const backlinksJson = (await ($.getJSON(backlinks_url) as any)) as IBacklinks;\n  cached_back_links = backlinksJson;\n  return cached_back_links;\n}\n\nasync function get_link_info(): Promise<IURLInfoMap> {\n  return (await get_back_links()).url_info;\n}\n\nfunction search() {\n  $(\"#autocomplete-search-box-button\").click();\n}\n\nfunction keyboard_shortcut_loader() {\n  const mouseTrap: any = Mousetrap();\n  mouseTrap.bind(\"s\", e => search());\n  mouseTrap.bind(\"t\", e => ForceShowRightSideBar());\n  mouseTrap.bind(\"p\", e => SwapProdAndTest());\n  mouseTrap.bind(\"a\", e => (location.href = \"/all\"));\n  mouseTrap.bind(\"m\", e => (location.href = \"/toc\"));\n  mouseTrap.bind(\"6\", e => (location.href = \"/ig66\"));\n\n  let shortcutHelp = `\nTry these shortcuts:\n  s - search\n  / - start chatting with others\n  t - force sidebar\n  p - swap prod and test\n  z - surprise me\n  a - all posts\n  m - global toc\n  6 - family journal\n  `;\n  mouseTrap.bind(\"?\", e => alert(shortcutHelp));\n}\n\n// Export and share with others.\n// https://stackoverflow.com/questions/2450954/how-to-randomize-shuffle-a-javascript-array\nfunction shuffle(list) {\n  return list\n    .map(value => ({ value, sort: Math.random() }))\n    .sort((a, b) => a.sort - b.sort)\n    .map(({ value }) => value);\n}\nfunction random_from_list(list) {\n  return shuffle(list)[0];\n}\n\n// This div gets content from the random_html_factory\n// and clicking does a re-randomize\nasync function append_randomizer_div(\n  parent_id: string | JQuery<HTMLElement>,\n  random_html_factory: () => string\n) {\n  // as string to queit type checker.\n  // Will be a noop if parent_id is already a jquery object\n  const $parent = $(parent_id as string);\n  if ($parent.length != 1) {\n    console.log(`append_randomizer_div ${parent_id} not present`);\n    return;\n  }\n  const new_element = $(await random_html_factory());\n  $parent.empty().append(new_element);\n\n  // Clicking on the element should result in a reload, unless you're\n  // Clicking on a link\n  $parent.click(async function (event) {\n    if (event.target.tagName != \"A\") {\n      const new_element = $(await random_html_factory());\n      $parent.empty().append(new_element);\n    }\n  });\n}\n\nfunction load_globals() {\n  $(add_link_loader);\n  $(keyboard_shortcut_loader);\n  $(() => {\n    // TOC Generation should go to posts.\n    generateToc(\"ui-toc\", true);\n    generateToc(\"ui-toc-affix\", false);\n  });\n}\n\nexport {\n  load_globals,\n  get_link_info,\n  MakeBackLinkHTML,\n  shuffle,\n  random_from_list,\n  append_randomizer_div,\n};\n"],"names":[],"version":3,"file":"idv-blog-module.js.map"}